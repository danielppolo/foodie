<div class="foodie-wrapper">
<div id="viewport">

  <ul class="stack">
    <% @meals.each do |m| %>
    <li class="flip-container" >
      <div class="flipper">

        <div class="front">
          <div class="touchable-front">
            <div class="card-photo" style= "background-image: url('<%= m.photo %>'); "></div>

            <div class="card-header">
              <h2 class="card-meal-name"><%= m.name.split(" ").first(3).join(" ") %></h2>
              <h2 class=" card-meal-price"><%=humanized_money_with_symbol(m.price) %></h2>
            </div>
          </div>
        </div>

        <div class="back">
          <div class="touchable-back">

            <%
            base_link = "https://api.mapbox.com/styles/v1/mapbox/streets-v10/static/pin-s-a+9ed4bd(#{@lng},#{@lat}),pin-s-b+000(#{m.restaurant.longitude},#{m.restaurant.latitude})#{",path-5+f44-0.5(#{@paths[m.id]})" if @paths[m.id]}/auto/600x600?access_token=pk.eyJ1Ijoib2Rwb2xvIiwiYSI6ImNqOXQ0YzY3NTNuOGYzM2xnMTMzN3AwMWgifQ.pylpAlDnFVGkJPfl5-N-ng"

            final_url = base_link
            %>

              <div class="map" id="" style="background-image: url('<%= final_url %>'); background-repeat: no-repeat;">

                </div>
                  <div class="card-map-details">
                    <h3><%= m.name %></h3>
                    <p><%= m.description %></p>
                  </div>
              </div>
            <div class="card-button">
              <form action="/meals/<%= m.id %>/orders/new">
                <button type="submit">Order now!</button>
              </form>
            </div>
          </div>
        </div>

      </li>
      <% end %>
      <!-- TUTORIAL -->
      <li class="flip-container" >
        <div class="flipper" id="tutorial-card">
          <div class="front">
            <div class="touchable-front card-centered-content">
              <div class="card-instructions">
                <h2><span>Touch</span> to see more details!</h2>
              </div>
            </div>
          </div>

          <div class="back">
            <div class="touchable-front">
              <div class="card-instructions">
                <h2>Don't like it?</h2>
                <h2>Just <span>swipe left</span> to discard</h2>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>
  <%= javascript_pack_tag 'card-stack' %>
  <%= javascript_pack_tag 'swing' %>


<!-- <div class ="map" id="map-%= m.id %>"
                data-markers="%= [{ lat: @lat, lng: @lng }, { lat: "#{m.restaurant.latitude}", lng: "#{m.restaurant.longitude}" }].to_json %>"
                >
                </div> -->
